<div class="drsl-dialog drsl-case-details-view">
    <form ng-submit="vm.submit()">
        <div class="modal-body">
            <div>
                <!-- Dialog Header -->
                <div class="drsl-dialog-header">
                    <div><h2>CASE DETAILS: <span>{{vm.case.technology.name}} {{vm.case.id}} &nbsp; START: {{vm.case.dateCreated | date:"MM/dd/yy"}}</span><div class="pull-right"><span class="drsl-header-status">Status: {{vm.case.status.name}}</span></div></h2></div>
                </div>
                <!-- <div class="drsl-dialog-header">
                <div><h2>CASE DETAILS: <span>ID: {{vm.case.id}} &nbsp; START: {{vm.case.startDate | date:"MM/dd/yy h:mm a"}}</span><div class="pull-right"><span class="drsl-header-status">Status: {{vm.case.status}}</span></div></h2></div>
            </div> -->

            <!-- Dialog Content -->
            <div>
                <div class="drsl-dialog-content">
                    <!-- User -->
                    <div class="drsl-form-grid" style="text-align: right;">
                        <div class="drsl-label" translate="case.details.user">User</div>
                        <div class="drsl-value"  ng-if="vm.case.user.firstName && vm.case.user.lastName">{{vm.case.user.firstName}} {{vm.case.user.lastName}}</div>
                        <div class="drsl-value" ng-if="!vm.case.user.firstName || !vm.case.user.lastName">{{vm.case.user.email}}</div>
                    </div>
                    <!-- <div class="drsl-form-grid">
                    <div translate="case.details.user">User</div>
                    <div>{{vm.case.user}}</div>
                </div> -->

                <!-- Expert -->
                <div class="drsl-form-grid">
                    <div class="drsl-label" translate="case.professional.expert">Expert</div>
                    <div class="drsl-value">
                        <div>{{vm.case.expertaccount.user.firstName}} {{vm.case.expertaccount.user.lastName}}</div>
                        <contact-info contact="vm.case.expertaccount" chat-room="vm.case.chatRoom"></contact-info>
                    </div>
                </div>
                <!-- <div class="drsl-form-grid">
                <div translate="case.professional.expert">Expert</div>
                <div>
                <div>{{vm.expert.firstName}} {{vm.expert.lastName}}</div>
                <contact-info contact="vm.expert.contact" chat-room="vm.case.chatRoom"></contact-info>
            </div>
        </div> -->

        <!-- Summary -->
        <div class="drsl-form-grid">
            <div class="drsl-label" translate="case.details.summary">Summary</div>
            <div class="drsl-value">{{vm.summary}}</div>
            <!-- <div><input type="text" class="form-control" ng-model="vm.summary"></div> -->
        </div>
        <div class="drsl-form-grid">
            <div class="drsl-label" translate="case.details.technology">Technology</div>
            <div class="drsl-value">{{vm.case.technology.name}}</div>
        </div>

        <!-- Incident Details -->
        <div class="drsl-incident-items">
            <div style="text-align: left; margin-left: 134px;">
                <span class="drsl-label" style="padding-right: 6px;">Issue</span>
                <span class="drsl-value" style="margin-left: 1px;">
                    {{vm.case.issue.name}}<br>
                </span>
            </div>
            <div style="text-align: left;">
                <span class="drsl-label">Technology Properties</span>
                <br>
                <span ng-repeat="property in vm.technologyProps">
                    <span class="drsl-label">{{property.propertyname}}</span> <span class="drsl-value">{{property.propertyvalue}}</span><br>
                </span>
            </div>
        </div>
        <br>
        <!-- Uploaded Files -->
        <div class="drsl-form-grid">
            <div class="drsl-label" translate="case.details.uploadedFiles">Uploaded Files</div>
            <div>
                <div class="drsl-file-upload-section">
                    <div>
                        <file-upload attachment="vm.attachment" currentcase="vm.case.id"></file-upload>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dowloaded Files -->
        <!-- <div class="drsl-form-grid">
        <div translate="case.details.downloadedFiles">Downloaded Files</div>
        <div><i class="fa fa-minus"></i></div>
    </div> -->
    <div class="drsl-form-grid estimateLogList">
        <div class="drsl-label">Estimate History</div>
        <ol>
            <li class="drsl-value eLogList" ng-repeat="log in vm.estimateLogs | limitTo: vm.estimateLogs.length - 1 ">
                {{log}}
            </li>
        </ol>
    </div>
    <div class="drsl-form-grid" style="width: 688px;">
        <div class="drsl-label">Update History</div>
        <!-- <div class="historyBox"> -->
        <div>
            <table class="scroll table-striped">
                <thead>
                    <tr>
                        <th class="drsl-label">Message</th>
                        <th class="drsl-label" style="padding-left: 177px;">Date</th>
                        <th class="drsl-label" style="padding-left: 161px;">User/Expert</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="update in vm.updates track by $index" >
                        <td style="width: 345px; max-width: 345px; word-wrap: break-word;">{{update.updateMsg}}</td>
                        <td style="padding-left: 60px; white-space: nowrap;">{{update.dateUpdated | date:"MM/dd/yy h:mm a"}}</td>
                        <td style="padding-left: 70px; width: 180px !important;">{{update.user.login}}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- </div> -->
    </div>
    <!-- Chat Log -->
    <div class="drsl-form-grid" >
        <div class="drsl-label">Update Message</div>
        <div><textarea class="form-control drsl-value" name="updateHistory" id="updateHistory" cols="30" rows="5" ng-model="vm.updatemsg"></textarea></div>
    </div>
    <div class="drsl-form-grid" ng-if="vm.isExpert">
        <div>Update Type</div>
        <div class="escalation-form-grid">
            <div class="drsl-linear-radio">
                <div class="drsl-linear-radio">
                    <div class="drsl-radio-set tier-list" style="overflow-x: hidden;">
                        <div class="ng-scope request" ng-repeat="type in vm.updateTypes"><input name="{{type.name}}" id="{{type.name}}" type="radio" class="ng-pristine ng-untouched ng-valid ng-empty" aria-invalid="false" ng-model="vm.updateType" value="{{type}}"><label for="{{type.name}}" class="ng-binding" style="font-weight: normal;">{{vm.capitalizeFirstLetter(type.name)}}<br><span></span></label></div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Detailed Resolution -->
    <div class="drsl-form-grid" ng-if="vm.case.status.id == 4 || vm.case.status.id == 5">
        <div translate="case.details.detailedResolution">Detailed Resolution</div>
        <div ng-if="vm.isExpert"><textarea class="form-control" name="detailedResolution" id="detailedResolution" cols="30" rows="5" ng-model="vm.detailedResolutions[0].updateMsg"></textarea></div>
        <div ng-if="!vm.isExpert">{{vm.detailedResolutions[0].updateMsg}}</div>
    </div>

    <!-- <div class="drsl-form-grid">
    <div translate="case.details.chatLog">Chat Log</div>
    <div><textarea class="form-control" name="chatLog" id="chatLog" cols="30" rows="10"></textarea></div>
</div> -->
</div>
</div>
</div>

<!-- Main Buttons -->
<div class="drsl-dialog-buttons">
    <button class="btn btn-default" ng-click="vm.cancel($event)" translate="entity.action.cancel">Cancel</button>
    <button type="submit" class="btn btn-success" translate="entity.action.update">Update</button>
</div>
</div>
</form>
</div>
